"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6696],{6696:(y,f,l)=>{l.r(f),l.d(f,{AddUserPage:()=>C});var g=l(5861),m=l(6895),_=l(433),i=l(9985),e=l(4650),p=l(958),h=l(7977),U=l(1205);function Z(a,d){if(1&a&&(e.TgZ(0,"div",41),e._uU(1),e.qZA()),2&a){const s=e.oxw();e.xp6(1),e.Oqu(s.nameError)}}function A(a,d){if(1&a&&(e.TgZ(0,"div",41),e._uU(1),e.qZA()),2&a){const s=e.oxw();e.xp6(1),e.Oqu(s.emailError)}}function T(a,d){if(1&a&&(e.TgZ(0,"div",41),e._uU(1),e.qZA()),2&a){const s=e.oxw();e.xp6(1),e.Oqu(s.positionError)}}function v(a,d){if(1&a&&(e.TgZ(0,"div",41),e._uU(1),e.qZA()),2&a){const s=e.oxw();e.xp6(1),e.Oqu(s.staffError)}}const P=function(a){return{open:a}};let C=(()=>{var a;class d{constructor(t,n,o,r,c,u){this.alertController=t,this.toastController=n,this.db=o,this.loadingController=r,this.auth=c,this.navCtrl=u,this.emailRegex=/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/,this.role={history:"off",statistic:"off",employment:"off",wil:"off",addUser:"off",validation:"off"},this.isNavOpen=!1,this.navController=u}goToAllUsers(){this.navController.navigateForward("/all-users")}goToView(){this.navController.navigateBack("/staffprofile")}handleMenuClick(){console.log("Menu button clicked")}toggleNav(){console.log("menu"),this.isNavOpen=!this.isNavOpen}ngOnInit(){}getAdduserValue(t){this.role.addUser=t.target.checked?"on":"off"}getHistoryValue(t){this.role.history=t.target.checked?"on":"off"}getStatisticValue(t){this.role.statistic=t.target.checked?"on":"off"}getEmploymentValue(t){this.role.employment=t.target.checked?"on":"off"}getWilValue(t){this.role.wil=t.target.checked?"on":"off",console.log(this.role)}getValidationValue(t){this.role.validation=t.target.checked?"on":"off",console.log(this.role)}Validation(){var t=this;return(0,g.Z)(function*(){if(t.emailError=null,t.staffError=null,t.positionError=null,t.nameError=null,!t.name)return t.nameError="Please enter name.",void alert("Please enter name");if(!t.email)return t.emailError="Please enter email.",void alert("Please enter email");if(!t.emailRegex.test(t.email))return t.emailError="Please enter a valid email Address.",void alert("please enter a valid Address.");if(!t.position)return t.positionError="Please enter position.",void alert("Please enter position.");if(!t.staffNumber)return t.staffError="Please enter staff number.",void alert("Please enter staff number.");const n=yield t.loadingController.create({message:"Assigning",cssClass:"custom-loader-class"});yield n.present(),t.auth.createUserWithEmailAndPassword(t.email,t.staffNumber).then(o=>{o.user?t.db.collection("registeredStaff").add({Name:t.name,email:t.email,staffNumber:t.staffNumber,position:t.position,role:t.role}).then(()=>{n.dismiss(),alert("Staff registered successfully"),t.name="",t.email="",t.position="",t.staffNumber=""}).catch(r=>{n.dismiss(),alert(r.message)}):(n.dismiss(),alert("User not found"))}).catch(o=>{n.dismiss()})})()}updateUser(){const t=this.email;this.db.collection("registeredStaff").ref.where("email","==",t).get().then(n=>{const o=n;if(o.empty)return void alert("User not found");const r=o.docs[0].id;this.db.collection("registeredStaff").doc(r).update({Name:this.name,email:this.email,staffNumber:this.staffNumber,position:this.position,role:this.role}).then(()=>{alert("User updated successfully")}).catch(c=>{alert(c.message)})}).catch(n=>{alert(n.message)})}deleteUser(){const t=this.email;this.db.collection("registeredStaff").ref.where("email","==",t).get().then(n=>{const o=n;if(o.empty)return void alert("User not found");const r=o.docs[0].id;this.db.collection("registeredStaff").doc(r).delete().then(()=>{alert("User deleted successfully")}).catch(c=>{alert(c.message)})}).catch(n=>{alert(n.message)})}ionViewDidEnter(){this.getUser()}getUser(){var t=this;return(0,g.Z)(function*(){const n=yield t.auth.currentUser;if(n)try{const o=yield t.db.collection("registeredStaff").ref.where("email","==",n.email).get();o.empty||(t.userDocument=o.docs[0].data(),console.log(t.userDocument))}catch(o){console.error("Error getting user document:",o)}})()}goToEmployment(){var t=this;return(0,g.Z)(function*(){try{yield t.getUser(),t.userDocument&&t.userDocument.role&&"on"===t.userDocument.role.employment?t.navController.navigateForward("/employment-page"):(yield t.toastController.create({message:"Unauthorized user.",duration:2e3,position:"top"})).present()}catch(n){console.error("Error navigating to Employment Page:",n)}})()}goToValidator(){var t=this;return(0,g.Z)(function*(){try{yield t.getUser(),t.userDocument&&t.userDocument.role&&"on"===t.userDocument.role.validation?t.navController.navigateForward("/ga-validation"):(yield t.toastController.create({message:"Unauthorized user.",duration:2e3,position:"top"})).present()}catch(n){console.error("Error navigating to grade avaerage validator Page:",n)}})()}goToHistory(){var t=this;return(0,g.Z)(function*(){try{yield t.getUser(),t.userDocument&&t.userDocument.role&&"on"===t.userDocument.role.history?t.navController.navigateForward("/history"):(yield t.toastController.create({message:"Unauthorized user.",duration:2e3,position:"top"})).present()}catch(n){console.error("Error navigating to History Page:",n)}})()}goToReports(){var t=this;return(0,g.Z)(function*(){try{yield t.getUser(),t.userDocument&&t.userDocument.role&&"on"===t.userDocument.role.statistic?t.navController.navigateForward("/reports"):(yield t.toastController.create({message:"Unauthorized user.",duration:2e3,position:"top"})).present()}catch(n){console.error("Error navigating to Reports Page:",n)}})()}goToWil(){var t=this;return(0,g.Z)(function*(){try{yield t.getUser(),t.userDocument&&t.userDocument.role&&"on"===t.userDocument.role.wil?t.navController.navigateForward("/wil-page"):(yield t.toastController.create({message:"Unauthorized user.",duration:2e3,position:"top"})).present()}catch(n){console.error("Error navigating to WIL Page:",n)}})()}goToMenuPage(){this.navController.navigateForward("/menu").then(()=>{window.location.reload()})}presentConfirmationAlert(){var t=this;return(0,g.Z)(function*(){yield(yield t.alertController.create({header:"Confirmation",message:"Are you sure you want to SIGN OUT?",buttons:[{text:"Cancel",role:"cancel",cssClass:"my-custom-alert",handler:()=>{console.log("Confirmation canceled")}},{text:"Confirm",handler:()=>{t.auth.signOut().then(()=>{t.navController.navigateForward("/sign-in"),t.presentToast()}).catch(o=>{})}}]})).present()})()}presentToast(){var t=this;return(0,g.Z)(function*(){yield(yield t.toastController.create({message:"SIGNED OUT!",duration:1500,position:"top"})).present()})()}goToHomePage(){this.navController.navigateBack("/home")}}return(a=d).\u0275fac=function(t){return new(t||a)(e.Y36(i.Br),e.Y36(i.yF),e.Y36(h.ST),e.Y36(i.HT),e.Y36(U.zQ),e.Y36(p.SH))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-add-user"]],standalone:!0,features:[e.jDz],decls:121,vars:13,consts:[[3,"translucent"],[1,"header-container"],[1,"logo"],["src","assets\\MUT LOGO.png","alt","Logo"],[1,"hamburger-menu",3,"click"],[1,"bar"],[1,"nav-links",3,"ngClass"],[1,"nav-link",3,"click"],[1,"nav-link","business-dropdown"],["name","caret-down-outline"],[1,"dropdown-content"],[1,"dropdown-item",3,"click"],["routerLink","/staffprofile",1,"dropdown-item"],[2,"--background","url('assets/tiny.jpg') no-repeat center / cover",3,"fullscreen"],[1,"info"],[1,"cont"],["text-align","center"],["position","floating"],["name","person","slot","start"],["type","text","name","name",3,"ngModel","ngModelChange","input"],["class","error-message",4,"ngIf"],["name","mail","slot","start"],["type","email","name","email",3,"ngModel","ngModelChange","input"],["name","briefcase","slot","start"],["type","text","name","position",3,"ngModel","ngModelChange","input"],["name","people","slot","start"],["title","e.g if the year is 2024 (2134124)","type","text","name","staffNumber",3,"ngModel","ngModelChange","input"],["name","checkmark-circle-outline"],["name","time"],["slot","end",3,"ionChange"],["name","stats-chart"],["name","briefcase"],["name","school"],["name","person-add-sharp"],["name","checkmark-done-sharp"],["color","danger","fill","outline",1,"ion-margin-top",3,"click"],["slot","start","name","trash-outline"],["color","medium","fill","outline",1,"ion-margin-top",3,"click"],["slot","start","name","pencil-outline"],["color","success","fill","outline",1,"ion-margin-top",3,"click"],["slot","start","name","add-outline"],[1,"error-message"]],template:function(t,n){1&t&&(e.TgZ(0,"ion-header",0)(1,"nav")(2,"div",1)(3,"a",2),e._UZ(4,"img",3),e._uU(5,"Add User"),e.qZA(),e.TgZ(6,"div",4),e.NdJ("click",function(){return n.toggleNav()}),e._UZ(7,"div",5)(8,"div",5)(9,"div",5),e.qZA(),e.TgZ(10,"div",6)(11,"a",7),e.NdJ("click",function(){return n.goToMenuPage()}),e._uU(12,"Menu"),e.qZA(),e.TgZ(13,"div",8)(14,"span"),e._UZ(15,"ion-icon",9),e._uU(16,"Tasks"),e.qZA(),e.TgZ(17,"div",10)(18,"a",11),e.NdJ("click",function(){return n.goToValidator()}),e._uU(19,"Profile Validator"),e.qZA(),e.TgZ(20,"a",11),e.NdJ("click",function(){return n.goToEmployment()}),e._uU(21,"Employment"),e.qZA(),e.TgZ(22,"a",11),e.NdJ("click",function(){return n.goToHistory()}),e._uU(23,"History"),e.qZA(),e.TgZ(24,"a",11),e.NdJ("click",function(){return n.goToWil()}),e._uU(25,"WIL"),e.qZA(),e.TgZ(26,"a",12),e._uU(27,"Profile"),e.qZA()()(),e.TgZ(28,"a",7),e.NdJ("click",function(){return n.goToReports()}),e._uU(29,"Reports"),e.qZA(),e.TgZ(30,"a",7),e.NdJ("click",function(){return n.presentConfirmationAlert()}),e._uU(31,"Sign Out"),e.qZA()()()()(),e.TgZ(32,"ion-content",13)(33,"div",14)(34,"ion-label"),e._uU(35,"ADD & GRANT USER PRIVILEGES"),e.qZA()(),e.TgZ(36,"div",15)(37,"ion-card")(38,"ion-card-header")(39,"ion-card-title",16),e._uU(40,"Add User Info"),e.qZA()(),e.TgZ(41,"ion-card-content")(42,"ion-item")(43,"ion-label",17),e._uU(44,"Name"),e.qZA(),e._UZ(45,"ion-icon",18),e.TgZ(46,"ion-input",19),e.NdJ("ngModelChange",function(r){return n.name=r})("input",function(){return n.nameError=null}),e.qZA(),e.YNc(47,Z,2,1,"div",20),e.qZA(),e.TgZ(48,"ion-item")(49,"ion-label",17),e._uU(50,"Email"),e.qZA(),e._UZ(51,"ion-icon",21),e.TgZ(52,"ion-input",22),e.NdJ("ngModelChange",function(r){return n.email=r})("input",function(){return n.emailError=null}),e.qZA(),e.YNc(53,A,2,1,"div",20),e.qZA(),e.TgZ(54,"ion-item")(55,"ion-label",17),e._uU(56,"Position"),e.qZA(),e._UZ(57,"ion-icon",23),e.TgZ(58,"ion-input",24),e.NdJ("ngModelChange",function(r){return n.position=r})("input",function(){return n.positionError=null}),e.qZA(),e.YNc(59,T,2,1,"div",20),e.qZA(),e.TgZ(60,"ion-item")(61,"ion-label",17),e._uU(62,"Staff Number + year"),e.qZA(),e._UZ(63,"ion-icon",25),e.TgZ(64,"ion-input",26),e.NdJ("ngModelChange",function(r){return n.staffNumber=r})("input",function(){return n.staffError=null}),e.qZA(),e.YNc(65,v,2,1,"div",20),e.qZA()()(),e.TgZ(66,"div",14)(67,"ion-label"),e._uU(68,"ADD ROLE"),e.qZA()(),e.TgZ(69,"ion-card")(70,"ion-card-header")(71,"ion-card-subtitle"),e._UZ(72,"ion-icon",27),e.qZA()(),e.TgZ(73,"ion-card-content")(74,"ion-item")(75,"ion-label"),e._UZ(76,"ion-icon",28),e._uU(77," History "),e.qZA(),e.TgZ(78,"ion-toggle",29),e.NdJ("ionChange",function(r){return n.getHistoryValue(r)}),e.qZA()(),e.TgZ(79,"ion-item")(80,"ion-label"),e._UZ(81,"ion-icon",30),e._uU(82," Reports "),e.qZA(),e.TgZ(83,"ion-toggle",29),e.NdJ("ionChange",function(r){return n.getStatisticValue(r)}),e.qZA()(),e.TgZ(84,"ion-item")(85,"ion-label"),e._UZ(86,"ion-icon",31),e._uU(87," Employment "),e.qZA(),e.TgZ(88,"ion-toggle",29),e.NdJ("ionChange",function(r){return n.getEmploymentValue(r)}),e.qZA()(),e.TgZ(89,"ion-item")(90,"ion-label"),e._UZ(91,"ion-icon",32),e._uU(92," WIL "),e.qZA(),e.TgZ(93,"ion-toggle",29),e.NdJ("ionChange",function(r){return n.getWilValue(r)}),e.qZA()(),e.TgZ(94,"ion-item")(95,"ion-label"),e._UZ(96,"ion-icon",33),e._uU(97," AddUser "),e.qZA(),e.TgZ(98,"ion-toggle",29),e.NdJ("ionChange",function(r){return n.getAdduserValue(r)}),e.qZA()(),e.TgZ(99,"ion-item")(100,"ion-label"),e._UZ(101,"ion-icon",34),e._uU(102," Profile Validator "),e.qZA(),e.TgZ(103,"ion-toggle",29),e.NdJ("ionChange",function(r){return n.getValidationValue(r)}),e.qZA()(),e.TgZ(104,"ion-button",35),e.NdJ("click",function(){return n.deleteUser()}),e._UZ(105,"ion-icon",36),e._uU(106," Remove "),e.qZA(),e.TgZ(107,"ion-button",37),e.NdJ("click",function(){return n.updateUser()}),e._UZ(108,"ion-icon",38),e._uU(109," Update "),e.qZA(),e.TgZ(110,"ion-button",39),e.NdJ("click",function(){return n.Validation()}),e._UZ(111,"ion-icon",40),e._uU(112," Assign "),e.qZA()()()(),e._UZ(113,"br")(114,"br")(115,"br")(116,"ion-card"),e.qZA(),e.TgZ(117,"ion-footer"),e._uU(118," Designed by @"),e.TgZ(119,"b"),e._uU(120,"MUT INNOVATIONLAB"),e.qZA()()),2&t&&(e.Q6J("translucent",!0),e.xp6(10),e.Q6J("ngClass",e.VKq(11,P,n.isNavOpen)),e.xp6(22),e.Q6J("fullscreen",!0),e.xp6(14),e.Q6J("ngModel",n.name),e.xp6(1),e.Q6J("ngIf",n.nameError),e.xp6(5),e.Q6J("ngModel",n.email),e.xp6(1),e.Q6J("ngIf",n.emailError),e.xp6(5),e.Q6J("ngModel",n.position),e.xp6(1),e.Q6J("ngIf",n.positionError),e.xp6(5),e.Q6J("ngModel",n.staffNumber),e.xp6(1),e.Q6J("ngIf",n.staffError))},dependencies:[i.Pc,i.YG,i.PM,i.FN,i.Zi,i.tO,i.Dq,i.W2,i.fr,i.Gu,i.gu,i.pK,i.Ie,i.Q$,i.ho,i.w,i.j9,i.Fo,m.ez,m.mk,m.O5,_.u5,_.JJ,_.On,_.UX],styles:[".maroon[_ngcontent-%COMP%]{background-color:maroon}img[_ngcontent-%COMP%]{width:100px;height:60px}.cont[_ngcontent-%COMP%]{background-color:#fff;height:150px;width:100%}#popover-button[_ngcontent-%COMP%]{color:#fff}.info[_ngcontent-%COMP%]{background-color:#d3d3d3;text-align:center;margin-bottom:-10px}.dropdown[_ngcontent-%COMP%]{--border-radius: 30px}ion-content[_ngcontent-%COMP%]{--background:#ECF0F6}p[_ngcontent-%COMP%]{color:red}.munu[_ngcontent-%COMP%]{color:#fff;font-family:Arial;height:50px}ion-menu-button[_ngcontent-%COMP%]{color:#fff}ion-footer[_ngcontent-%COMP%]{background-color:#300505;color:#fcfcfc;text-align:center}.error-message[_ngcontent-%COMP%]{color:red;font-size:small;font-family:Arial}ion-header[_ngcontent-%COMP%]{background-color:maroon}"]}),d})()}}]);