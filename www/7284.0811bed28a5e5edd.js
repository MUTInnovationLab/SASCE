"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7284],{7284:(v,c,a)=>{a.r(c),a.d(c,{SignInPage:()=>M});var u=a(5861),h=a(6895),l=a(433),o=a(9985),e=a(4650),P=a(7977),_=a(958),C=a(1205);let M=(()=>{var s;class m{constructor(n,t,i,r,g,d){this.db=n,this.loadingController=t,this.auth=r,this.navController=g,this.toastController=d,this.emailRegex=/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/,this.passwordRegex=/^(?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[a-zA-Z]).{8,}$/}ngOnInit(){}goToHomePage(){this.navController.navigateBack("/home")}goToPage(){this.navController.navigateForward("/reset-p")}signUp(){this.navController.navigateForward("/create")}goToSignUp(){this.navController.navigateForward("/register")}validate(){var n=this;return(0,u.Z)(function*(){n.email?n.emailRegex.test(n.email)?n.password?n.passwordRegex.test(n.password)?n.log():(yield n.toastController.create({message:"Password must contain at least 8 characters including uppercase, lowercase, and numbers.",duration:2e3,color:"danger"})).present():(yield n.toastController.create({message:"Please enter your password.",duration:2e3,color:"danger"})).present():(yield n.toastController.create({message:"Please provide a valid email address.",duration:2e3,color:"danger"})).present():(yield n.toastController.create({message:"Please enter your email.",duration:2e3,color:"danger"})).present()})()}log(){var n=this;return(0,u.Z)(function*(){const t=yield n.loadingController.create({message:"Signing in",cssClass:"custom-loader-class"});try{if(yield t.present(),yield n.auth.signInWithEmailAndPassword(n.email,n.password)){(yield n.db.collection("studentProfile").ref.where("email","==",n.email).get()).forEach(f=>{const T=f.id,b=(f.data().loginCount||0)+1;n.db.collection("studentProfile").doc(T).update({loginCount:b})});const g=yield n.db.collection("registeredStudents").ref.where("email","==",n.email.trim()).get(),d=yield n.db.collection("registeredStaff").ref.where("email","==",n.email.trim()).get();g.empty?d.empty?(t.dismiss(),alert("User not found in registeredStudents or registeredStaff collections.")):(t.dismiss(),n.navController.navigateForward("/menu")):(t.dismiss(),n.navController.navigateForward("/view"))}}catch(i){t.dismiss();const r=i.message;"Firebase: The password is invalid or the user does not have a password. (auth/wrong-password)."===r||"Firebase: There is no user record corresponding to this identifier. The user may have been deleted. (auth/user-not-found)."===r?alert("Invalid email or password"):"Firebase: The email address is badly formatted. (auth/invalid-email)."===r&&alert("Incorrectly formatted email")}})()}}return(s=m).\u0275fac=function(n){return new(n||s)(e.Y36(P.ST),e.Y36(o.HT),e.Y36(_.SH),e.Y36(C.zQ),e.Y36(_.SH),e.Y36(o.yF))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-sign-in"]],standalone:!0,features:[e.jDz],decls:37,vars:2,consts:[["slot","start",1,"phuto",3,"click"],["src","assets\\MUT LOGO.png",1,"image-size"],[2,"--background","url('assets/tiny.jpg') no-repeat center / cover"],[1,"container"],[1,"center"],["src","assets\\Co-Oparative Education.png","alt","","srcset",""],[1,"color2"],[1,"rounded"],["type","email","name","email",3,"ngModel","ngModelChange"],[1,"color3"],["type","password","name","password",3,"ngModel","ngModelChange"],["type","submit","expand","block",3,"click"],[1,"forgotPass",3,"click"]],template:function(n,t){1&n&&(e.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),e.NdJ("click",function(){return t.goToHomePage()}),e._UZ(3,"img",1),e.qZA()()(),e.TgZ(4,"ion-content",2)(5,"div",3)(6,"div",4),e._UZ(7,"img",5),e.qZA()(),e.TgZ(8,"ion-card")(9,"ion-card-content"),e._UZ(10,"br"),e.TgZ(11,"div",6)(12,"ion-label"),e._uU(13,"Email Address"),e.qZA(),e.TgZ(14,"ion-item",7)(15,"ion-input",8),e.NdJ("ngModelChange",function(r){return t.email=r}),e.qZA()(),e._UZ(16,"br"),e.TgZ(17,"ion-label",9),e._uU(18,"Password"),e.qZA(),e.TgZ(19,"ion-item",7)(20,"ion-input",10),e.NdJ("ngModelChange",function(r){return t.password=r}),e.qZA()(),e._UZ(21,"br"),e.TgZ(22,"ion-button",11),e.NdJ("click",function(){return t.log()}),e._uU(23,"LOGIN"),e.qZA(),e.TgZ(24,"div")(25,"ion-label"),e._uU(26,"Already have an account?"),e.qZA(),e.TgZ(27,"ion-label",12),e.NdJ("click",function(){return t.goToSignUp()}),e._uU(28,"Sign Up"),e.qZA()(),e.TgZ(29,"ion-label"),e._uU(30,"Forgot Password?"),e.qZA(),e.TgZ(31,"ion-label",12),e.NdJ("click",function(){return t.goToPage()}),e._uU(32,"Reset"),e.qZA()()()()(),e.TgZ(33,"ion-footer"),e._uU(34," Designed by @"),e.TgZ(35,"b"),e._uU(36,"MUT INNOVATIONLAB"),e.qZA()()),2&n&&(e.xp6(15),e.Q6J("ngModel",t.email),e.xp6(5),e.Q6J("ngModel",t.password))},dependencies:[o.Pc,o.YG,o.Sm,o.PM,o.FN,o.W2,o.fr,o.Gu,o.pK,o.Ie,o.Q$,o.sr,o.j9,h.ez,l.u5,l.JJ,l.On],styles:[".center[_ngcontent-%COMP%]{text-align:center;height:100%;width:100%}ion-content[_ngcontent-%COMP%]{--background:#fff}.container[_ngcontent-%COMP%]{margin-left:20px;margin-right:20px;text-align:center;font-size:14px}ion-card[_ngcontent-%COMP%]{background-color:#802b28;width:80%;max-width:500px;margin:auto;box-shadow:#000}.rounded[_ngcontent-%COMP%]{border-radius:10px}.color2[_ngcontent-%COMP%]{color:#fcfcfcf1;font-size:large}.forgotPass[_ngcontent-%COMP%]{margin-right:0%;color:#f8fc06}.signUp[_ngcontent-%COMP%]{margin-right:0%;color:#000;text-align:right}ion-button[_ngcontent-%COMP%]{--background:#C89015;font-weight:bolder;font-family:sans-serif;color:#fff;box-shadow:#000}ion-button[_ngcontent-%COMP%]:hover{box-shadow:10px 10px 30px #acc5cc}.align[_ngcontent-%COMP%]{display:flex;justify-content:space-between}img[_ngcontent-%COMP%]{height:150px;width:550px}.centerImg[_ngcontent-%COMP%]{text-align:center}ion-footer[_ngcontent-%COMP%]{background-color:#300505;color:#fcfcfc;text-align:center}ion-card-content[_ngcontent-%COMP%]{font-family:Arial}.image-size[_ngcontent-%COMP%]{width:100px;height:60px;padding-top:0;padding-bottom:0;margin-bottom:0}.header-title[_ngcontent-%COMP%]{margin-left:-8%;text-align:center;color:#fff;font-weight:700}ion-buttons[_ngcontent-%COMP%]{margin:0;padding:0}"]}),m})()}}]);